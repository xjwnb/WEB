# DOM

## 获取元素

### 1.getElementById

通过节点的 id 属性获取元素。

`document.getElementById(id);`

### 2.getElementsByTagName

通过标签名称获取元素。

`document.getElementsByTagName(tag);`

### 3.getElementsByClassName

通过节点的 class 属性获取元素

`document.getElementsByClassName;`

### 4.特殊集合

`document.anchors` 包含文档中所有带 name 属性的 <a> 元素。

`document.forms` 包含文档中所有 <form> 元素与 `document.getElementsByTagName("form")` 效果相同。

`document.images` 包含文档中所有 <img> 元素与 `document.getElementsByTagName("img")` 效果相同。

`document.links` 包含文档中所有带有 href 属性的 <a> 元素。  

## 获取和设置

### 1.getAttribute

获取元素对象中查询属性的值

`object.getAttribute(attribute);`

### 2.setAttribute

设置元素对象中的属性

`object.setAttribute(attribute, value);`

## 节点关系

每个节点都有一个 `childNodes` 属性。其中包含一个 `NodeList` 的实例。`NodeList` 是一个类数组对象，用于存储可以按位置存放的有序节点。

访问 `NodeList` 中的元素：

```javascript
let firstChild = someNode.childNodes[0];
let secondChild = someNode.childNodes.item(1);
let lastChild = someNode.childNodes[someNode.childNodes.length - 1];
let length = someNode.childNodes.length;
```

所有 `childNodes` 中的所有节点都有同一个父元素。它们的 `parentNode` 属性都指向同一个父元素。因此它们都是同胞节点。`childNodes`  中可以使用 `previousSibling` 和 `nextSibling` 。第一个节点的 `perviousSibling` 属性为 null，最后一个节点的 `nextSibling` 也为 null。父节点中的第一个和最后一个子节点都有专属属性：`firstChild` 和 `lastChild` 分别指向 `childNodes` 中的第一个和最后一个子节点。

## 操纵节点

`appendChild()` 用于在 childNodes 列表末尾**添加节点**。添加新节点会更新相关的关系指针，包括父节点和之前的最后一个节点。`appendChild()` 方法返回新添加的节点。

```javascript
let returnNode = someNode.appendChild(newNode);
console.log(returnNode == newNode); // true
console.log(someNode.lastChild == newNode); // true
```

如果把文档中已经存在的节点传递给 `appendChild()` ,则这个节点会从之前的位置被转移到新位置。

```javascript
let returnNode = someNode.appendChild(someNode.firstChild);
console.log(returnNode == someNode.firstChild); // false
console.log(returnNode == someNode.lastChild); // true
```

`insertBefore()` 方法可以将节点插入到指定节点前面。有两个参数：要插入的节点和参照的节点。倘若传入的参照节点为 null ，则和 `appendChild()` 效果相同。

```javascript
// 插入到最后一个子节点与 appendChild() 相同。
let returnNode = someNode.insertBefore(newNode, null);
console.log(returnNode == someNode.lastChild); // true

// 作为第一个子节点插入
returnNode = someNode.insertBefore(newNode, someNode.firstChild);
console.log(returnNode == newNode); // true
console.log(returnNode == someNode.firstNode); // true

// 插入到最后一个子节点前面
returnNode = someNode.insertBefore(newNode, someNode.lastChild);
console.log(returnNode == someNode.childNodes[someNode.childNodes.length - 2]); // true
```

`replaceChild()` 方法会替代对应子节点。接收两个参数：要插入的节点和要替换的节点。

```javascript
// 替换第一个子节点
let returnNode = someNode.replaceChild(newNode, someNode.firstChild);
```

**移除节点**，可以使用 `removeChild()` 方法。接收一个参数：要移除的节点，返回被移除的节点。

```javascript
// 删除第一个子节点
let formerFirstChild = someNode.removeChild(someNode.firstChild);
```

**复制节点**，可以使用 `cloneNode()` 方法，会返回调用它的节点一模一样的节点。接收一个布尔值参数：表示是否深复制。传入 true 表示会进行深复制。传入 false 则相反。复制之后虽然属于文档所有，但是是一个孤儿节点。所以要通过 `appendChild()` 、 `insertBefor()`  或者 `replaceChild()` 添加到文档中。

## 操纵文本

文本方法：

- `appendData(text)`，向节点末尾添加文本 text；

- `deleteData(offset, count)`，从位置 offset 开始删除 count 个字符；

- `insertData(offset, text)`，在位置 offset 插入 text；

- `replaceData(offset, count, text)`，用 text 替换从位置 offset 到 offset + count 的文本；

- `splitText(offset)`，在位置 offset 将当前文本节点拆分为两个文本节点；

- `substringData(offset, count)`，提取从位置 offset 到 offset + count 的文本。

### 创建文本节点

`document.createTextNode()` 可以用来创建新文本节点。接收一个参数：要插入节点的文本。

```javascript
let textNode = document.createTextNode("<strong>小卡车加油！</strong>");
```

创建完成文本节点后，仍然需要把文本节点添加到文档树中。可使用 `appendChild()` 、`insertBefore()` 或者 `replaceChild()` 。

### 规范化文本节点

一个文本节点足以表示一个文本字符串，偶尔会出现多个相邻文本节点。可用 `normalize()` 合并相邻文本节点。

```javascript
let ele = document.createElement("div");
let textNode1 = document.createTextNode("小卡车");
ele.appendChild(textNode1);
let textNode2 = document.createTextNode("加油！");
ele.appendChild(textNode2);
document.body.appendChild(ele);
console.log(ele.childNodes.length); // 2
// 合并
ele.normalize();
console.log(ele.childNodes.length); // 1
console.log(ele.firstChild.nodeValue); // 小卡车加油！
```



## Element 类型

特征：

- nodeType 等于 1；
- nodeName 值为元素标签名；
- nodeValue 值为 null；
- parentNode 值为 Document 或者 Element 对象。

## Text 类型

特征：

- nodeType 等于 3；
- nodeName 值为 "#text"；
- nodeValue 值为节点中包含的文本；
- parentNode 值为 Element 对象；
- 不支持子节点。

